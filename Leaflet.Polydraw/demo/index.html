<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite + TS</title>
    <style>
      /* Stack for demo helper panels (status + sample polygons) */
      #polydraw-panel-stack {
        position: absolute;
        top: 10px;
        left: 60px;
        z-index: 10000;
        display: flex;
        flex-direction: column;
        gap: 12px;
        max-width: 420px;
      }

      .polydraw-panel {
        background: rgba(255, 255, 255, 0.5);
        border: 2px solid #333;
        border-radius: 8px;
        padding: 12px;
        font-family: Arial, sans-serif;
        font-size: 14px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        backdrop-filter: blur(4px);
      }

      #predefined-controls h3,
      #polydraw-status h3 {
        margin: 0 0 10px 0;
        color: #333;
        font-size: 16px;
      }

      .panel-toggle {
        display: flex;
        align-items: center;
        gap: 6px;
        width: 100%;
        text-align: left;
        background: none;
        border: 0;
        padding: 0;
        font: inherit;
        color: inherit;
        cursor: pointer;
        user-select: none;
      }

      #polygon-count {
        margin-bottom: 8px;
        font-weight: bold;
      }

      #polygon-structure {
        font-family: monospace;
        font-size: 12px;
        color: #666;
      }

      #predefined-controls small {
        display: block;
        margin-top: 6px;
        color: #444;
        opacity: 0.85;
      }

      .sample-button-grid {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 6px;
      }

      .sample-button-grid button {
        border: 1px solid #333;
        border-radius: 6px;
        padding: 6px 8px;
        background: rgba(255, 255, 255, 0.85);
        cursor: pointer;
        font-size: 13px;
        font-weight: 600;
        transition:
          background 0.2s ease,
          transform 0.1s ease;
      }

      .sample-button-grid button:hover {
        background: rgba(76, 175, 80, 0.15);
      }

      .sample-button-grid button:active {
        transform: scale(0.97);
      }

      .marker-generator-row {
        margin-top: 10px;
        display: grid;
        grid-template-columns: auto 1fr auto;
        gap: 6px;
        align-items: center;
      }

      #samples-extra {
        margin-top: 8px;
      }

      .demo-point-marker {
        width: 10px;
        height: 10px;
        background: rgba(33, 111, 219, 0.85);
        border: 1px solid rgba(10, 42, 82, 0.9);
        border-radius: 50%;
        box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.7);
      }

      .demo-point-marker.is-inside {
        background: rgba(33, 169, 96, 0.95);
        border-color: rgba(10, 90, 48, 0.95);
        box-shadow:
          0 0 0 1px rgba(255, 255, 255, 0.7),
          0 0 6px rgba(33, 169, 96, 0.55);
        opacity: 1;
      }

      .demo-point-marker.is-outside {
        background: rgba(120, 135, 155, 0.45);
        border-color: rgba(60, 70, 92, 0.6);
        box-shadow: none;
        opacity: 0.45;
      }

      .marker-generator-row label {
        font-weight: 600;
        color: #333;
      }

      .marker-generator-row input {
        width: 100%;
        border: 1px solid #333;
        border-radius: 6px;
        padding: 6px 8px;
        font-size: 13px;
        background: rgba(255, 255, 255, 0.85);
      }

      .marker-generator-row button {
        border: 1px solid #333;
        border-radius: 6px;
        padding: 6px 10px;
        background: rgba(255, 255, 255, 0.85);
        cursor: pointer;
        font-size: 13px;
        font-weight: 600;
        transition:
          background 0.2s ease,
          transform 0.1s ease;
      }

      .marker-generator-row button:hover {
        background: rgba(76, 175, 80, 0.15);
      }

      .marker-generator-row button:active {
        transform: scale(0.97);
      }

      #point-filter-summary {
        margin-top: 6px;
        font-size: 12px;
        color: #333;
        font-weight: 600;
      }

      @media (max-width: 1024px) {
        #polydraw-panel-stack {
          max-width: 380px !important;
        }
      }
      @media (max-width: 768px) {
        #polydraw-panel-stack {
          max-width: 340px !important;
        }
      }
      @media (max-width: 500px) {
        /* iPhone 14/Max and similar */
        #polydraw-panel-stack {
          display: none;
          max-width: 280px !important;
          left: 60px !important;
        }
      }
    </style>
  </head>
  <body style="margin: 0">
    <div id="map" style="height: 100vh"></div>
    <script type="module" src="/src/main.ts"></script>

    <div id="polydraw-panel-stack">
      <!-- Status Box -->
      <div id="polydraw-status" class="polydraw-panel" style="min-width: 200px">
        <h3 style="cursor: pointer; user-select: none" id="version-header">
          Leaflet version detection
        </h3>
        <div id="leaflet-version-detection" style="margin-bottom: 8px; font-weight: bold"></div>
        <h3>
          <button type="button" id="status-header" class="panel-toggle" aria-expanded="true">
            Polygon Status
            <span data-chevron="status" style="display: inline-flex; transition: transform 0.2s ease">
              &#x25BC;
            </span>
          </button>
        </h3>
        <div id="polygon-status-content">
          <div id="polygon-count">
            Polygons: <span id="count-value">0</span>
          </div>
          <div id="polygon-structure">
            <div id="structure-value">[]</div>
          </div>
        </div>
      </div>

      <div id="predefined-controls" class="polydraw-panel">
        <h3>
          <button type="button" id="samples-header" class="panel-toggle" aria-expanded="true">
            Sample polygons
            <span data-chevron="sample" style="display: inline-flex; transition: transform 0.2s ease">
              &#x25BC;
            </span>
          </button>
        </h3>
        <div id="samples-content" class="sample-button-grid">
          <button type="button" data-sample="star16">Star (16)</button>
          <button type="button" data-sample="star1024">Star (1024)</button>
          <button type="button" data-sample="octagon">Octagon</button>
          <button type="button" data-sample="squareHole">Square + hole</button>
          <button type="button" data-sample="overlap">Overlap</button>
          <button type="button" data-sample="linkoping-0">LKPG (SE) • V.O. 0</button>
          <button type="button" data-sample="linkoping-4">LKPG (SE) • V.O. 4</button>
          <button type="button" data-sample="linkoping-7">LKPG (SE) • V.O. 7</button>
          <button type="button" data-sample="linkoping-10">LKPG (SE) • V.O. 10</button>
        </div>
        <div id="samples-extra">
          <div class="marker-generator-row">
            <label for="marker-count">Vertices</label>
            <input id="marker-count" type="number" min="3" max="2000" step="1" value="200" />
            <button type="button" id="marker-generate">Generate</button>
          </div>
          <small>Generates a single polygon with N vertices spread across the current view.</small>
          <div class="marker-generator-row">
            <label for="point-count">Points</label>
            <input id="point-count" type="number" min="1" max="2000" step="1" value="500" />
            <button type="button" id="point-generate">Generate</button>
          </div>
          <small>Adds N map markers spread across the current view.</small>
          <div id="point-filter-summary">Points in polygons: 0 / 0</div>
          <small>V.O. = visualOptimizationLevel applied when adding the polygon.</small>
        </div>
      </div>
    </div>
  </body>
</html>
